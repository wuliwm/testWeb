import{u as at,b as wt,d as Nt,e as It,E as Et}from"./button-Bwg9CGH_.js";import{d as St,g as lt,v as kt,S as $t,E as Vt}from"./StatusTag-BPz7fhZE.js";import{E as Ct,a as xt,b as Tt}from"./form-item-DC5pnUg2.js";import{C as Le,u as zt,U as we,I as Ae,E as st}from"./input-Zeg5Ryk4.js";import{aK as At,aL as He,n as Q,k as ie,l as ee,q as be,d as j,s as ge,av as De,aM as Dt,aN as Ge,r as M,t as T,x as Pe,y as ve,H as Te,a9 as nt,V as Ne,ai as Pt,c as P,o as h,e as y,A as K,B as he,D,j as t,W as Re,F as _e,am as ye,J as je,ah as Rt,z as B,w as v,C as Ue,ad as Ie,ac as $e,aj as Ee,a4 as le,aq as Se,f,aO as ot,aG as Lt,a0 as Y,i as ae,L,I as rt,M as Ot,aP as Qe,aQ as Mt,aR as Ft,G as We,aS as Bt,aT as qt,aU as jt,T as Ut,a3 as it,E as oe,aE as Wt,aD as Kt,aa as Yt,aV as Xt,aW as Ht,aX as Gt,aY as Qt,aZ as Zt,Q as ut,$ as me,a_ as Jt,a$ as ea,b0 as Ve,ag as ta,N as Ze,a1 as ct,Y as Me,Z as Fe,b1 as aa,v as dt,b2 as la,b3 as sa,b4 as na,a as ft,ab as ze,ap as Ce,aC as oa,b5 as Je,a2 as ra,b6 as ia,b7 as ua,aF as ca,b8 as da,_ as pt,g as fa,b9 as pa,h as ma,aJ as Be}from"./index-DYA2KCe6.js";import{C as va}from"./CountdownTimer-BRHmKe_d.js";import{g as ba,f as ga,E as ya,a as ha}from"./vnode-CXmCMggY.js";import{v as et}from"./index-CH4p1y18.js";var _a="Expected a function";function qe(i,u,n){var l=!0,p=!0;if(typeof i!="function")throw new TypeError(_a);return At(n)&&(l="leading"in n?!!n.leading:l,p="trailing"in n?!!n.trailing:p),St(i,u,{leading:l,maxWait:u,trailing:p})}const wa=ie({zIndex:{type:ee([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),Na={scroll:({scrollTop:i,fixed:u})=>Q(i)&&He(u),[Le]:i=>He(i)},mt="ElAffix",Ia=j({name:mt}),Ea=j({...Ia,props:wa,emits:Na,setup(i,{expose:u,emit:n}){const l=i,p=ge("affix"),c=De(),a=De(),g=De(),{height:w}=Dt(),{height:s,width:E,top:S,bottom:F,update:C}=Ge(a,{windowScroll:!1}),x=Ge(c),k=M(!1),V=M(0),m=M(0),z=T(()=>({height:k.value?`${s.value}px`:"",width:k.value?`${E.value}px`:""})),N=T(()=>{if(!k.value)return{};const $=l.offset?Pe(l.offset):0;return{height:`${s.value}px`,width:`${E.value}px`,top:l.position==="top"?$:"",bottom:l.position==="bottom"?$:"",transform:m.value?`translateY(${m.value}px)`:"",zIndex:l.zIndex}}),X=()=>{if(!g.value)return;V.value=g.value instanceof Window?document.documentElement.scrollTop:g.value.scrollTop||0;const{position:$,target:U,offset:te}=l,Z=te+s.value;if($==="top")if(U){const H=x.bottom.value-Z;k.value=te>S.value&&x.bottom.value>0,m.value=H<0?H:0}else k.value=te>S.value;else if(U){const H=w.value-x.top.value-Z;k.value=w.value-te<F.value&&w.value>x.top.value,m.value=H<0?-H:0}else k.value=w.value-te<F.value},I=async()=>{if(!k.value){C();return}k.value=!1,await Re(),C(),k.value=!0},r=async()=>{C(),await Re(),n("scroll",{scrollTop:V.value,fixed:k.value})};return ve(k,$=>n(Le,$)),Te(()=>{var $;l.target?(c.value=($=document.querySelector(l.target))!=null?$:void 0,c.value||nt(mt,`Target does not exist: ${l.target}`)):c.value=document.documentElement,g.value=lt(a.value,!0),C()}),Ne(g,"scroll",r),Pt(X),u({update:X,updateRoot:I}),($,U)=>(h(),P("div",{ref_key:"root",ref:a,class:D(t(p).b()),style:he(t(z))},[y("div",{class:D({[t(p).m("fixed")]:k.value}),style:he(t(N))},[K($.$slots,"default")],6)],6))}});var Sa=be(Ea,[["__file","affix.vue"]]);const ka=_e(Sa),$a=ie({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:ee([Number,Object]),default:()=>ye({})},sm:{type:ee([Number,Object]),default:()=>ye({})},md:{type:ee([Number,Object]),default:()=>ye({})},lg:{type:ee([Number,Object]),default:()=>ye({})},xl:{type:ee([Number,Object]),default:()=>ye({})}}),vt=Symbol("rowContextKey"),Va=j({name:"ElCol"}),Ca=j({...Va,props:$a,setup(i){const u=i,{gutter:n}=je(vt,{gutter:T(()=>0)}),l=ge("col"),p=T(()=>{const a={};return n.value&&(a.paddingLeft=a.paddingRight=`${n.value/2}px`),a}),c=T(()=>{const a=[];return["span","offset","pull","push"].forEach(s=>{const E=u[s];Q(E)&&(s==="span"?a.push(l.b(`${u[s]}`)):E>0&&a.push(l.b(`${s}-${u[s]}`)))}),["xs","sm","md","lg","xl"].forEach(s=>{Q(u[s])?a.push(l.b(`${s}-${u[s]}`)):Rt(u[s])&&Object.entries(u[s]).forEach(([E,S])=>{a.push(E!=="span"?l.b(`${s}-${E}-${S}`):l.b(`${s}-${S}`))})}),n.value&&a.push(l.is("guttered")),[l.b(),a]});return(a,g)=>(h(),B(Ue(a.tag),{class:D(t(c)),style:he(t(p))},{default:v(()=>[K(a.$slots,"default")]),_:3},8,["class","style"]))}});var xa=be(Ca,[["__file","col.vue"]]);const Ta=_e(xa),Ke=Symbol("elDescriptions");var xe=j({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:je(Ke,{})}},render(){var i;const u=ba(this.cell),n=(((i=this.cell)==null?void 0:i.dirs)||[]).map(m=>{const{dir:z,arg:N,modifiers:X,value:I}=m;return[z,I,N,X]}),{border:l,direction:p}=this.descriptions,c=p==="vertical",a=()=>{var m,z,N;return((N=(z=(m=this.cell)==null?void 0:m.children)==null?void 0:z.label)==null?void 0:N.call(z))||u.label},g=()=>{var m,z,N;return(N=(z=(m=this.cell)==null?void 0:m.children)==null?void 0:z.default)==null?void 0:N.call(z)},w=u.span,s=u.rowspan,E=u.align?`is-${u.align}`:"",S=u.labelAlign?`is-${u.labelAlign}`:E,F=u.className,C=u.labelClassName,x=this.type==="label"&&(u.labelWidth||this.descriptions.labelWidth)||u.width,k={width:Pe(x),minWidth:Pe(u.minWidth)},V=ge("descriptions");switch(this.type){case"label":return Ie($e(this.tag,{style:k,class:[V.e("cell"),V.e("label"),V.is("bordered-label",l),V.is("vertical-label",c),S,C],colSpan:c?w:1,rowspan:c?1:s},a()),n);case"content":return Ie($e(this.tag,{style:k,class:[V.e("cell"),V.e("content"),V.is("bordered-content",l),V.is("vertical-content",c),E,F],colSpan:c?w:w*2-1,rowspan:c?s*2-1:s},g()),n);default:{const m=a(),z={},N=Pe(u.labelWidth||this.descriptions.labelWidth);return N&&(z.width=N,z.display="inline-block"),Ie($e("td",{style:k,class:[V.e("cell"),E],colSpan:w,rowspan:s},[Ee(m)?void 0:$e("span",{style:z,class:[V.e("label"),C]},m),$e("span",{class:[V.e("content"),F]},g())]),n)}}}});const za=ie({row:{type:ee(Array),default:()=>[]}}),Aa=j({name:"ElDescriptionsRow"}),Da=j({...Aa,props:za,setup(i){const u=je(Ke,{});return(n,l)=>t(u).direction==="vertical"?(h(),P(le,{key:0},[y("tr",null,[(h(!0),P(le,null,Se(n.row,(p,c)=>(h(),B(t(xe),{key:`tr1-${c}`,cell:p,tag:"th",type:"label"},null,8,["cell"]))),128))]),y("tr",null,[(h(!0),P(le,null,Se(n.row,(p,c)=>(h(),B(t(xe),{key:`tr2-${c}`,cell:p,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(h(),P("tr",{key:1},[(h(!0),P(le,null,Se(n.row,(p,c)=>(h(),P(le,{key:`tr3-${c}`},[t(u).border?(h(),P(le,{key:0},[f(t(xe),{cell:p,tag:"td",type:"label"},null,8,["cell"]),f(t(xe),{cell:p,tag:"td",type:"content"},null,8,["cell"])],64)):(h(),B(t(xe),{key:1,cell:p,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var Pa=be(Da,[["__file","descriptions-row.vue"]]);const Ra=ie({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:ot,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),bt="ElDescriptionsItem",La=j({name:"ElDescriptions"}),Oa=j({...La,props:Ra,setup(i){const u=i,n=ge("descriptions"),l=at(),p=Lt();rt(Ke,u);const c=T(()=>[n.b(),n.m(l.value)]),a=(w,s,E,S=!1)=>(w.props||(w.props={}),s>E&&(w.props.span=E),S&&(w.props.span=s),w),g=()=>{if(!p.default)return[];const w=ga(p.default()).filter(x=>{var k;return((k=x?.type)==null?void 0:k.name)===bt}),s=[];let E=[],S=u.column,F=0;const C=[];return w.forEach((x,k)=>{var V,m,z;const N=((V=x.props)==null?void 0:V.span)||1,X=((m=x.props)==null?void 0:m.rowspan)||1,I=s.length;if(C[I]||(C[I]=0),X>1)for(let r=1;r<X;r++)C[z=I+r]||(C[z]=0),C[I+r]++,F++;if(C[I]>0&&(S-=C[I],C[I]=0),k<w.length-1&&(F+=N>S?S:N),k===w.length-1){const r=u.column-F%u.column;E.push(a(x,r,S,!0)),s.push(E);return}N<S?(S-=N,E.push(x)):(E.push(a(x,N,S)),s.push(E),S=u.column,E=[])}),s};return(w,s)=>(h(),P("div",{class:D(t(c))},[w.title||w.extra||w.$slots.title||w.$slots.extra?(h(),P("div",{key:0,class:D(t(n).e("header"))},[y("div",{class:D(t(n).e("title"))},[K(w.$slots,"title",{},()=>[ae(L(w.title),1)])],2),y("div",{class:D(t(n).e("extra"))},[K(w.$slots,"extra",{},()=>[ae(L(w.extra),1)])],2)],2)):Y("v-if",!0),y("div",{class:D(t(n).e("body"))},[y("table",{class:D([t(n).e("table"),t(n).is("bordered",w.border)])},[y("tbody",null,[(h(!0),P(le,null,Se(g(),(E,S)=>(h(),B(Pa,{key:S,row:E},null,8,["row"]))),128))])],2)],2)],2))}});var Ma=be(Oa,[["__file","description.vue"]]);const tt=["left","center","right"],Fa=ie({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,values:tt,default:"left"},labelAlign:{type:String,values:tt},className:{type:String,default:""},labelClassName:{type:String,default:""}}),gt=j({name:bt,props:Fa}),Ba=_e(Ma,{DescriptionsItem:gt}),qa=Ot(gt),ja=ie({urlList:{type:ee(Array),default:()=>ye([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:ee(String)}}),Ua={close:()=>!0,error:i=>i instanceof Event,switch:i=>Q(i),rotate:i=>Q(i)},Wa=j({name:"ElImageViewer"}),Ka=j({...Wa,props:ja,emits:Ua,setup(i,{expose:u,emit:n}){var l;const p=i,c={CONTAIN:{name:"contain",icon:Qe(Ft)},ORIGINAL:{name:"original",icon:Qe(Mt)}};let a,g="";const{t:w}=We(),s=ge("image-viewer"),{nextZIndex:E}=Bt(),S=M(),F=M(),C=qt(),x=T(()=>{const{scale:d,minScale:W,maxScale:q}=p;return jt(d,W,q)}),k=M(!0),V=M(!1),m=M(p.initialIndex),z=De(c.CONTAIN),N=M({scale:x.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),X=M((l=p.zIndex)!=null?l:E()),I=T(()=>{const{urlList:d}=p;return d.length<=1}),r=T(()=>m.value===0),$=T(()=>m.value===p.urlList.length-1),U=T(()=>p.urlList[m.value]),te=T(()=>[s.e("btn"),s.e("prev"),s.is("disabled",!p.infinite&&r.value)]),Z=T(()=>[s.e("btn"),s.e("next"),s.is("disabled",!p.infinite&&$.value)]),H=T(()=>{const{scale:d,deg:W,offsetX:q,offsetY:re,enableTransition:fe}=N.value;let ne=q/d,pe=re/d;const ke=W*Math.PI/180,Ye=Math.cos(ke),Xe=Math.sin(ke);ne=ne*Ye+pe*Xe,pe=pe*Ye-q/d*Xe;const Oe={transform:`scale(${d}) rotate(${W}deg) translate(${ne}px, ${pe}px)`,transition:fe?"transform .3s":""};return z.value.name===c.CONTAIN.name&&(Oe.maxWidth=Oe.maxHeight="100%"),Oe}),J=T(()=>`${m.value+1} / ${p.urlList.length}`);function G(){ue(),a?.(),document.body.style.overflow=g,n("close")}function se(){const d=qe(q=>{switch(ut(q)){case me.esc:p.closeOnPressEscape&&G();break;case me.space:b();break;case me.left:ce();break;case me.up:O("zoomIn");break;case me.right:de();break;case me.down:O("zoomOut");break}}),W=qe(q=>{const re=q.deltaY||q.deltaX;O(re<0?"zoomIn":"zoomOut",{zoomRate:p.zoomRate,enableTransition:!1})});C.run(()=>{Ne(document,"keydown",d),Ne(document,"wheel",W)})}function ue(){C.stop()}function e(){k.value=!1}function o(d){V.value=!0,k.value=!1,n("error",d),d.target.alt=w("el.image.error")}function _(d){if(k.value||d.button!==0||!S.value)return;N.value.enableTransition=!1;const{offsetX:W,offsetY:q}=N.value,re=d.pageX,fe=d.pageY,ne=qe(ke=>{N.value={...N.value,offsetX:W+ke.pageX-re,offsetY:q+ke.pageY-fe}}),pe=Ne(document,"mousemove",ne);Ne(document,"mouseup",()=>{pe()}),d.preventDefault()}function A(){N.value={scale:x.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function b(){if(k.value||V.value)return;const d=Zt(c),W=Object.values(c),q=z.value.name,fe=(W.findIndex(ne=>ne.name===q)+1)%d.length;z.value=c[d[fe]],A()}function R(d){V.value=!1;const W=p.urlList.length;m.value=(d+W)%W}function ce(){r.value&&!p.infinite||R(m.value-1)}function de(){$.value&&!p.infinite||R(m.value+1)}function O(d,W={}){if(k.value||V.value)return;const{minScale:q,maxScale:re}=p,{zoomRate:fe,rotateDeg:ne,enableTransition:pe}={zoomRate:p.zoomRate,rotateDeg:90,enableTransition:!0,...W};switch(d){case"zoomOut":N.value.scale>q&&(N.value.scale=Number.parseFloat((N.value.scale/fe).toFixed(3)));break;case"zoomIn":N.value.scale<re&&(N.value.scale=Number.parseFloat((N.value.scale*fe).toFixed(3)));break;case"clockwise":N.value.deg+=ne,n("rotate",N.value.deg);break;case"anticlockwise":N.value.deg-=ne,n("rotate",N.value.deg);break}N.value.enableTransition=pe}function yt(d){var W;((W=d.detail)==null?void 0:W.focusReason)==="pointer"&&d.preventDefault()}function ht(){p.closeOnPressEscape&&G()}function _t(d){if(d.ctrlKey){if(d.deltaY<0)return d.preventDefault(),!1;if(d.deltaY>0)return d.preventDefault(),!1}}return ve(()=>x.value,d=>{N.value.scale=d}),ve(U,()=>{Re(()=>{const d=F.value;d?.complete||(k.value=!0)})}),ve(m,d=>{A(),n("switch",d)}),Te(()=>{se(),a=Ne("wheel",_t,{passive:!1}),g=document.body.style.overflow,document.body.style.overflow="hidden"}),u({setActiveItem:R}),(d,W)=>(h(),B(t(ha),{to:"body",disabled:!d.teleported},{default:v(()=>[f(Ut,{name:"viewer-fade",appear:""},{default:v(()=>[y("div",{ref_key:"wrapper",ref:S,tabindex:-1,class:D(t(s).e("wrapper")),style:he({zIndex:X.value})},[f(t(ya),{loop:"",trapped:"","focus-trap-el":S.value,"focus-start-el":"container",onFocusoutPrevented:yt,onReleaseRequested:ht},{default:v(()=>[y("div",{class:D(t(s).e("mask")),onClick:it(q=>d.hideOnClickModal&&G(),["self"])},null,10,["onClick"]),Y(" CLOSE "),y("span",{class:D([t(s).e("btn"),t(s).e("close")]),onClick:G},[f(t(oe),null,{default:v(()=>[f(t(Wt))]),_:1})],2),Y(" ARROW "),t(I)?Y("v-if",!0):(h(),P(le,{key:0},[y("span",{class:D(t(te)),onClick:ce},[f(t(oe),null,{default:v(()=>[f(t(Kt))]),_:1})],2),y("span",{class:D(t(Z)),onClick:de},[f(t(oe),null,{default:v(()=>[f(t(Yt))]),_:1})],2)],64)),d.$slots.progress||d.showProgress?(h(),P("div",{key:1,class:D([t(s).e("btn"),t(s).e("progress")])},[K(d.$slots,"progress",{activeIndex:m.value,total:d.urlList.length},()=>[ae(L(t(J)),1)])],2)):Y("v-if",!0),Y(" ACTIONS "),y("div",{class:D([t(s).e("btn"),t(s).e("actions")])},[y("div",{class:D(t(s).e("actions__inner"))},[K(d.$slots,"toolbar",{actions:O,prev:ce,next:de,reset:b,activeIndex:m.value,setActiveItem:R},()=>[f(t(oe),{onClick:q=>O("zoomOut")},{default:v(()=>[f(t(Xt))]),_:1},8,["onClick"]),f(t(oe),{onClick:q=>O("zoomIn")},{default:v(()=>[f(t(Ht))]),_:1},8,["onClick"]),y("i",{class:D(t(s).e("actions__divider"))},null,2),f(t(oe),{onClick:b},{default:v(()=>[(h(),B(Ue(t(z).icon)))]),_:1}),y("i",{class:D(t(s).e("actions__divider"))},null,2),f(t(oe),{onClick:q=>O("anticlockwise")},{default:v(()=>[f(t(Gt))]),_:1},8,["onClick"]),f(t(oe),{onClick:q=>O("clockwise")},{default:v(()=>[f(t(Qt))]),_:1},8,["onClick"])])],2)],2),Y(" CANVAS "),y("div",{class:D(t(s).e("canvas"))},[V.value&&d.$slots["viewer-error"]?K(d.$slots,"viewer-error",{key:0,activeIndex:m.value,src:t(U)}):(h(),P("img",{ref_key:"imgRef",ref:F,key:t(U),src:t(U),style:he(t(H)),class:D(t(s).e("img")),crossorigin:d.crossorigin,onLoad:e,onError:o,onMousedown:_},null,46,["src","crossorigin"]))],2),K(d.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var Ya=be(Ka,[["__file","image-viewer.vue"]]);const Xa=_e(Ya),Ha=ie({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ee([String,Object])},previewSrcList:{type:ee(Array),default:()=>ye([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:ee(String)}}),Ga={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>Q(i),close:()=>!0,show:()=>!0},Qa=j({name:"ElImage",inheritAttrs:!1}),Za=j({...Qa,props:Ha,emits:Ga,setup(i,{expose:u,emit:n}){const l=i,{t:p}=We(),c=ge("image"),a=Jt(),g=T(()=>ea(Object.entries(a).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),w=zt({excludeListeners:!0,excludeKeys:T(()=>Object.keys(g.value))}),s=M(),E=M(!1),S=M(!0),F=M(!1),C=M(),x=M(),k=Ve&&"loading"in HTMLImageElement.prototype;let V;const m=T(()=>[c.e("inner"),N.value&&c.e("preview"),S.value&&c.is("loading")]),z=T(()=>{const{fit:e}=l;return Ve&&e?{objectFit:e}:{}}),N=T(()=>{const{previewSrcList:e}=l;return ta(e)&&e.length>0}),X=T(()=>{const{previewSrcList:e,initialIndex:o}=l;let _=o;return o>e.length-1&&(_=0),_}),I=T(()=>l.loading==="eager"?!1:!k&&l.loading==="lazy"||l.lazy),r=()=>{Ve&&(S.value=!0,E.value=!1,s.value=l.src)};function $(e){S.value=!1,E.value=!1,n("load",e)}function U(e){S.value=!1,E.value=!0,n("error",e)}function te(e){e&&(r(),J())}const Z=na(te,200,!0);async function H(){var e;if(!Ve)return;await Re();const{scrollContainer:o}=l;if(aa(o))x.value=o;else if(dt(o)&&o!=="")x.value=(e=document.querySelector(o))!=null?e:void 0;else if(C.value){const A=lt(C.value);x.value=la(A)?void 0:A}const{stop:_}=sa(C,([A])=>{Z(A.isIntersecting)},{root:x});V=_}function J(){!Ve||!Z||(V?.(),x.value=void 0,V=void 0)}function G(){N.value&&(F.value=!0,n("show"))}function se(){F.value=!1,n("close")}function ue(e){n("switch",e)}return ve(()=>l.src,()=>{I.value?(S.value=!0,E.value=!1,J(),H()):r()}),Te(()=>{I.value?H():r()}),u({showPreview:G}),(e,o)=>(h(),P("div",Ze({ref_key:"container",ref:C},t(g),{class:[t(c).b(),e.$attrs.class]}),[E.value?K(e.$slots,"error",{key:0},()=>[y("div",{class:D(t(c).e("error"))},L(t(p)("el.image.error")),3)]):(h(),P(le,{key:1},[s.value!==void 0?(h(),P("img",Ze({key:0},t(w),{src:s.value,loading:e.loading,style:t(z),class:t(m),crossorigin:e.crossorigin,onClick:G,onLoad:$,onError:U}),null,16,["src","loading","crossorigin"])):Y("v-if",!0),S.value?(h(),P("div",{key:1,class:D(t(c).e("wrapper"))},[K(e.$slots,"placeholder",{},()=>[y("div",{class:D(t(c).e("placeholder"))},null,2)])],2)):Y("v-if",!0)],64)),t(N)?(h(),P(le,{key:2},[F.value?(h(),B(t(Xa),{key:0,"z-index":e.zIndex,"initial-index":t(X),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,scale:e.scale,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:se,onSwitch:ue},ct({toolbar:v(_=>[K(e.$slots,"toolbar",Me(Fe(_)))]),default:v(()=>[e.$slots.viewer?(h(),P("div",{key:0},[K(e.$slots,"viewer")])):Y("v-if",!0)]),_:2},[e.$slots.progress?{name:"progress",fn:v(_=>[K(e.$slots,"progress",Me(Fe(_)))])}:void 0,e.$slots["viewer-error"]?{name:"viewer-error",fn:v(_=>[K(e.$slots,"viewer-error",Me(Fe(_)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","scale","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):Y("v-if",!0)],64)):Y("v-if",!0)],16))}});var Ja=be(Za,[["__file","image.vue"]]);const el=_e(Ja),tl=ie({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:ot,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:i=>i===null||Q(i)||["min","max"].includes(i),default:null},name:String,placeholder:String,precision:{type:Number,validator:i=>i>=0&&i===Number.parseInt(`${i}`,10)},validateEvent:{type:Boolean,default:!0},...wt(["ariaLabel"]),inputmode:{type:ee(String),default:void 0},align:{type:ee(String),default:"center"},disabledScientific:Boolean}),al={[Le]:(i,u)=>u!==i,blur:i=>i instanceof FocusEvent,focus:i=>i instanceof FocusEvent,[Ae]:i=>Q(i)||Ee(i),[we]:i=>Q(i)||Ee(i)},ll=j({name:"ElInputNumber"}),sl=j({...ll,props:tl,emits:al,setup(i,{expose:u,emit:n}){const l=i,{t:p}=We(),c=ge("input-number"),a=M(),g=ft({currentValue:l.modelValue,userInput:null}),{formItem:w}=Nt(),s=T(()=>Q(l.modelValue)&&l.modelValue<=l.min),E=T(()=>Q(l.modelValue)&&l.modelValue>=l.max),S=T(()=>{const e=m(l.step);return ze(l.precision)?Math.max(m(l.modelValue),e):(e>l.precision&&Ce("InputNumber","precision should not be less than the decimal places of step"),l.precision)}),F=T(()=>l.controls&&l.controlsPosition==="right"),C=at(),x=It(),k=T(()=>{if(g.userInput!==null)return g.userInput;let e=g.currentValue;if(Ee(e))return"";if(Q(e)){if(Number.isNaN(e))return"";ze(l.precision)||(e=e.toFixed(l.precision))}return e}),V=(e,o)=>{if(ze(o)&&(o=S.value),o===0)return Math.round(e);let _=String(e);const A=_.indexOf(".");if(A===-1||!_.replace(".","").split("")[A+o])return e;const ce=_.length;return _.charAt(ce-1)==="5"&&(_=`${_.slice(0,Math.max(0,ce-1))}6`),Number.parseFloat(Number(_).toFixed(o))},m=e=>{if(Ee(e))return 0;const o=e.toString(),_=o.indexOf(".");let A=0;return _!==-1&&(A=o.length-_-1),A},z=(e,o=1)=>Q(e)?e>=Number.MAX_SAFE_INTEGER&&o===1?(Ce("InputNumber","The value has reached the maximum safe integer limit."),e):e<=Number.MIN_SAFE_INTEGER&&o===-1?(Ce("InputNumber","The value has reached the minimum safe integer limit."),e):V(e+l.step*o):g.currentValue,N=e=>{const o=ut(e),_=da(e);if(l.disabledScientific&&["e","E"].includes(_)){e.preventDefault();return}switch(o){case me.up:{e.preventDefault(),X();break}case me.down:{e.preventDefault(),I();break}}},X=()=>{if(l.readonly||x.value||E.value)return;const e=Number(k.value)||0,o=z(e);$(o),n(Ae,g.currentValue),se()},I=()=>{if(l.readonly||x.value||s.value)return;const e=Number(k.value)||0,o=z(e,-1);$(o),n(Ae,g.currentValue),se()},r=(e,o)=>{const{max:_,min:A,step:b,precision:R,stepStrictly:ce,valueOnClear:de}=l;_<A&&nt("InputNumber","min should not be greater than max.");let O=Number(e);if(Ee(e)||Number.isNaN(O))return null;if(e===""){if(de===null)return null;O=dt(de)?{min:A,max:_}[de]:de}return ce&&(O=V(Math.round(V(O/b))*b,R),O!==e&&o&&n(we,O)),ze(R)||(O=V(O,R)),(O>_||O<A)&&(O=O>_?_:A,o&&n(we,O)),O},$=(e,o=!0)=>{var _;const A=g.currentValue,b=r(e);if(!o){n(we,b);return}A===b&&e||(g.userInput=null,n(we,b),A!==b&&n(Le,b,A),l.validateEvent&&((_=w?.validate)==null||_.call(w,"change").catch(R=>Ce(R))),g.currentValue=b)},U=e=>{g.userInput=e;const o=e===""?null:Number(e);n(Ae,o),$(o,!1)},te=e=>{const o=e!==""?Number(e):"";(Q(o)&&!Number.isNaN(o)||e==="")&&$(o),se(),g.userInput=null},Z=()=>{var e,o;(o=(e=a.value)==null?void 0:e.focus)==null||o.call(e)},H=()=>{var e,o;(o=(e=a.value)==null?void 0:e.blur)==null||o.call(e)},J=e=>{n("focus",e)},G=e=>{var o,_;g.userInput=null,g.currentValue===null&&((o=a.value)!=null&&o.input)&&(a.value.input.value=""),n("blur",e),l.validateEvent&&((_=w?.validate)==null||_.call(w,"blur").catch(A=>Ce(A)))},se=()=>{g.currentValue!==l.modelValue&&(g.currentValue=l.modelValue)},ue=e=>{document.activeElement===e.target&&e.preventDefault()};return ve(()=>l.modelValue,(e,o)=>{const _=r(e,!0);g.userInput===null&&_!==o&&(g.currentValue=_)},{immediate:!0}),ve(()=>l.precision,()=>{g.currentValue=r(l.modelValue)}),Te(()=>{var e;const{min:o,max:_,modelValue:A}=l,b=(e=a.value)==null?void 0:e.input;if(b.setAttribute("role","spinbutton"),Number.isFinite(_)?b.setAttribute("aria-valuemax",String(_)):b.removeAttribute("aria-valuemax"),Number.isFinite(o)?b.setAttribute("aria-valuemin",String(o)):b.removeAttribute("aria-valuemin"),b.setAttribute("aria-valuenow",g.currentValue||g.currentValue===0?String(g.currentValue):""),b.setAttribute("aria-disabled",String(x.value)),!Q(A)&&A!=null){let R=Number(A);Number.isNaN(R)&&(R=null),n(we,R)}b.addEventListener("wheel",ue,{passive:!1})}),oa(()=>{var e,o;const _=(e=a.value)==null?void 0:e.input;_?.setAttribute("aria-valuenow",`${(o=g.currentValue)!=null?o:""}`)}),u({focus:Z,blur:H}),(e,o)=>(h(),P("div",{class:D([t(c).b(),t(c).m(t(C)),t(c).is("disabled",t(x)),t(c).is("without-controls",!e.controls),t(c).is("controls-right",t(F)),t(c).is(e.align,!!e.align)]),onDragstart:it(()=>{},["prevent"])},[e.controls?Ie((h(),P("span",{key:0,role:"button","aria-label":t(p)("el.inputNumber.decrease"),class:D([t(c).e("decrease"),t(c).is("disabled",t(s))]),onKeydown:Je(I,["enter"])},[K(e.$slots,"decrease-icon",{},()=>[f(t(oe),null,{default:v(()=>[t(F)?(h(),B(t(ra),{key:0})):(h(),B(t(ia),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(et),I]]):Y("v-if",!0),e.controls?Ie((h(),P("span",{key:1,role:"button","aria-label":t(p)("el.inputNumber.increase"),class:D([t(c).e("increase"),t(c).is("disabled",t(E))]),onKeydown:Je(X,["enter"])},[K(e.$slots,"increase-icon",{},()=>[f(t(oe),null,{default:v(()=>[t(F)?(h(),B(t(ua),{key:0})):(h(),B(t(ca),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(et),X]]):Y("v-if",!0),f(t(st),{id:e.id,ref_key:"input",ref:a,type:"number",step:e.step,"model-value":t(k),placeholder:e.placeholder,readonly:e.readonly,disabled:t(x),size:t(C),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeydown:N,onBlur:G,onFocus:J,onInput:U,onChange:te},ct({_:2},[e.$slots.prefix?{name:"prefix",fn:v(()=>[K(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:v(()=>[K(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode"])],42,["onDragstart"]))}});var nl=be(sl,[["__file","input-number.vue"]]);const ol=_e(nl),rl=["start","center","end","space-around","space-between","space-evenly"],il=["top","middle","bottom"],ul=ie({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:rl,default:"start"},align:{type:String,values:il}}),cl=j({name:"ElRow"}),dl=j({...cl,props:ul,setup(i){const u=i,n=ge("row"),l=T(()=>u.gutter);rt(vt,{gutter:l});const p=T(()=>{const a={};return u.gutter&&(a.marginRight=a.marginLeft=`-${u.gutter/2}px`),a}),c=T(()=>[n.b(),n.is(`justify-${u.justify}`,u.justify!=="start"),n.is(`align-${u.align}`,!!u.align)]);return(a,g)=>(h(),B(Ue(a.tag),{class:D(t(c)),style:he(t(p))},{default:v(()=>[K(a.$slots,"default")]),_:3},8,["class","style"]))}});var fl=be(dl,[["__file","row.vue"]]);const pl=_e(fl),ml={class:"image-grid"},vl=j({__name:"ImagePreview",props:{images:{},size:{}},setup(i){const u=i,n=u.size??72;return(l,p)=>{const c=el;return h(),P("div",ml,[(h(!0),P(le,null,Se(u.images,(a,g)=>(h(),B(c,{key:g,src:a,"preview-src-list":u.images,"initial-index":g,fit:"cover",style:he({width:`${t(n)}px`,height:`${t(n)}px`}),lazy:""},null,8,["src","preview-src-list","initial-index","style"]))),128))])}}}),bl=pt(vl,[["__scopeId","data-v-c8fa6aba"]]),gl={class:"page-detail"},yl={key:0,class:"header"},hl={class:"header-right"},_l={class:"card-header"},wl={class:"item-list"},Nl={class:"item-header"},Il={class:"item-code"},El={class:"item-meta"},Sl={class:"item-body"},kl={class:"item-info"},$l={class:"item-form"},Vl={class:"card-header"},Cl={class:"summary-content"},xl={class:"summary-value"},Tl=j({__name:"QuotationDetail",setup(i){const u=fa(),n=ma(),l=u.params.id,p=M(!1),c=M(!1),a=M(null),g=M(!1),w=M(""),s=ft({}),E=M(""),S=T(()=>a.value?a.value.status!=="expired"&&a.value.status!=="closed":!1),F=T(()=>a.value?a.value.items.reduce((I,r)=>{const $=m(r.itemId);return $.quotedPrice?I+$.quotedPrice*r.quantity:I},0):0);let C=null;const x=async()=>{p.value=!0;try{const I=await Be.quotations.getDetail(l);a.value=I,E.value=I.remarks??"",k(I.items)}finally{p.value=!1}},k=I=>{Object.keys(s).forEach(r=>{delete s[r]}),I.forEach(r=>{s[r.itemId]={itemId:r.itemId,quotedPrice:r.quotedPrice,deliveryDays:r.deliveryDays,brand:r.brand,origin:r.origin,warranty:r.warranty,itemRemarks:r.itemRemarks}})},V=()=>{S.value&&(C&&globalThis.clearTimeout(C),C=globalThis.setTimeout(z,1500))},m=I=>(s[I]||(s[I]={itemId:I}),s[I]),z=async()=>{if(a.value){g.value=!0;try{const I={items:Object.values(s).map($=>({itemId:$.itemId,quotedPrice:$.quotedPrice,deliveryDays:$.deliveryDays,brand:$.brand,origin:$.origin,warranty:$.warranty,itemRemarks:$.itemRemarks}))},r=await Be.quotations.saveDraft(a.value.id,I);w.value=`已自动保存 ${new Date(r.savedAt).toLocaleTimeString()}`}finally{g.value=!1}}},N=()=>{if(!a.value)return!1;for(const I of a.value.items){const r=m(I.itemId);if(!r||!r.quotedPrice||!r.deliveryDays)return!1}return!0},X=async()=>{if(a.value){c.value=!0;try{const I={items:a.value.items.map(r=>({...m(r.itemId),itemId:r.itemId})),remarks:E.value};await Be.quotations.submit(a.value.id,I),await x(),n.push("/history")}finally{c.value=!1}}};return Te(x),ve(s,()=>V(),{deep:!0}),pa(()=>{C&&(globalThis.clearTimeout(C),C=null)}),(I,r)=>{const $=Et,U=qa,te=Ba,Z=Vt,H=ol,J=xt,G=st,se=Ct,ue=Ta,e=Tt,o=ka,_=pl,A=kt;return Ie((h(),P("div",gl,[a.value?(h(),P("header",yl,[y("div",null,[y("h1",null,L(a.value.projectName),1),y("p",null,"报价单号："+L(a.value.quotationNo)+" · 氚云编号："+L(a.value.qingyunId),1)]),y("div",hl,[f($t,{status:a.value.status},null,8,["status"]),S.value?(h(),B(va,{key:0,"end-date":a.value.endDate},null,8,["end-date"])):Y("",!0),f($,{type:"primary",plain:"",onClick:r[0]||(r[0]=b=>t(n).back())},{default:v(()=>[...r[2]||(r[2]=[ae("返回",-1)])]),_:1})])])):Y("",!0),a.value?(h(),B(_,{key:1,gutter:24},{default:v(()=>[f(ue,{lg:16,md:24},{default:v(()=>[f(Z,{class:"info-card"},{header:v(()=>[...r[3]||(r[3]=[y("div",{class:"card-header"},[y("h2",null,"报价单信息")],-1)])]),default:v(()=>[f(te,{column:2,border:""},{default:v(()=>[f(U,{label:"报价起止"},{default:v(()=>[ae(L(a.value.startDate.slice(0,10))+" 至 "+L(a.value.endDate.slice(0,10)),1)]),_:1}),f(U,{label:"联系人"},{default:v(()=>[ae(L(a.value.contactPerson),1)]),_:1}),f(U,{label:"联系电话"},{default:v(()=>[ae(L(a.value.contactPhone),1)]),_:1}),f(U,{label:"交货地址"},{default:v(()=>[ae(L(a.value.deliveryAddress),1)]),_:1}),f(U,{label:"付款条款",span:2},{default:v(()=>[ae(L(a.value.paymentTerms),1)]),_:1}),f(U,{label:"备注",span:2},{default:v(()=>[ae(L(a.value.remarks||"—"),1)]),_:1})]),_:1})]),_:1}),f(Z,{class:"info-card"},{header:v(()=>[y("div",_l,[r[4]||(r[4]=y("h2",null,"物品清单",-1)),y("span",null,"共 "+L(a.value.items.length)+" 项",1)])]),default:v(()=>[y("div",wl,[(h(!0),P(le,null,Se(a.value.items,b=>(h(),B(Z,{key:b.itemId,class:"item-card",shadow:"hover"},{default:v(()=>[y("div",Nl,[y("div",null,[y("p",Il,"#"+L(b.itemNo),1),y("h3",null,L(b.itemName),1)]),y("div",El,[y("p",null,"数量："+L(b.quantity)+" "+L(b.unit),1),y("p",null,"交货日期："+L(b.requiredDeliveryDate.slice(0,10)),1)])]),y("div",Sl,[y("div",kl,[y("p",null,"规格："+L(b.specification),1),y("p",null,"说明："+L(b.description),1),y("p",null,"备注："+L(b.remarks||"—"),1),b.images?.length?(h(),B(bl,{key:0,images:b.images},null,8,["images"])):Y("",!0)]),y("div",$l,[f(se,{"label-position":"top",disabled:!S.value},{default:v(()=>[f(J,{label:"报价单价 (元)",required:""},{default:v(()=>[f(H,{modelValue:m(b.itemId).quotedPrice,"onUpdate:modelValue":R=>m(b.itemId).quotedPrice=R,min:0,precision:2,step:10,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f(J,{label:"交货天数",required:""},{default:v(()=>[f(H,{modelValue:m(b.itemId).deliveryDays,"onUpdate:modelValue":R=>m(b.itemId).deliveryDays=R,min:1,step:1,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f(J,{label:"品牌"},{default:v(()=>[f(G,{modelValue:m(b.itemId).brand,"onUpdate:modelValue":R=>m(b.itemId).brand=R,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f(J,{label:"产地"},{default:v(()=>[f(G,{modelValue:m(b.itemId).origin,"onUpdate:modelValue":R=>m(b.itemId).origin=R,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f(J,{label:"质保期"},{default:v(()=>[f(G,{modelValue:m(b.itemId).warranty,"onUpdate:modelValue":R=>m(b.itemId).warranty=R,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f(J,{label:"物品备注"},{default:v(()=>[f(G,{modelValue:m(b.itemId).itemRemarks,"onUpdate:modelValue":R=>m(b.itemId).itemRemarks=R,modelModifiers:{trim:!0},type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["disabled"])])])]),_:2},1024))),128))])]),_:1})]),_:1}),f(ue,{lg:8,md:24},{default:v(()=>[f(o,{offset:24},{default:v(()=>[f(Z,{class:"summary-card"},{header:v(()=>[y("div",Vl,[r[5]||(r[5]=y("h2",null,"报价概览",-1)),y("span",null,L(a.value.quotedItemCount)+"/"+L(a.value.itemCount)+" 已报价",1)])]),default:v(()=>[y("div",Cl,[y("p",xl,"¥ "+L(F.value.toFixed(2)),1),r[8]||(r[8]=y("p",{class:"summary-desc"},"自动计算所有物品的报价合计金额",-1)),f(se,{"label-position":"top",disabled:!S.value},{default:v(()=>[f(J,{label:"整体备注"},{default:v(()=>[f(G,{modelValue:E.value,"onUpdate:modelValue":r[1]||(r[1]=b=>E.value=b),modelModifiers:{trim:!0},type:"textarea",rows:4,placeholder:"填写补充说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled"]),w.value?(h(),B(e,{key:0,title:w.value,type:"info",closable:!1,"show-icon":""},null,8,["title"])):Y("",!0),S.value?(h(),B($,{key:1,type:"primary",size:"large",disabled:!N()||g.value,loading:c.value,onClick:X},{default:v(()=>[...r[6]||(r[6]=[ae(" 提交报价 ",-1)])]),_:1},8,["disabled","loading"])):(h(),B($,{key:2,size:"large",disabled:""},{default:v(()=>[...r[7]||(r[7]=[ae("此报价单不可编辑",-1)])]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})):Y("",!0)])),[[A,p.value]])}}}),Fl=pt(Tl,[["__scopeId","data-v-f1bb81b8"]]);export{Fl as default};
