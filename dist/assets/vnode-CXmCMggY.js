import{f as ue}from"./button-Bwg9CGH_.js";import{H as K,P as D,r as S,b0 as z,Q as te,$ as se,q as ne,d as oe,A as U,y as R,j as F,aj as ce,W,v as ie,I as fe,k as de,l as le,z as pe,o as ve,cx as Ee,F as me,ag as k,ax as m,ap as Te,bY as Fe,cy as be}from"./index-DYA2KCe6.js";const I="focus-trap.focus-after-trapped",A="focus-trap.focus-after-released",ye="focus-trap.focusout-prevented",M={cancelable:!0,bubbles:!1},_e={cancelable:!0,bubbles:!1},Y="focusAfterTrapped",J="focusAfterReleased",Pe=Symbol("elFocusTrap"),$=S(),g=S(0),B=S(0);let b=0;const re=e=>{const o=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const r=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||r?NodeFilter.FILTER_SKIP:t.tabIndex>=0||t===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)o.push(n.currentNode);return o},Q=(e,o)=>{for(const n of e)if(!Se(n,o))return n},Se=(e,o)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(o&&e===o)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},ge=e=>{const o=re(e),n=Q(o,e),t=Q(o.reverse(),e);return[n,t]},Le=e=>e instanceof HTMLInputElement&&"select"in e,l=(e,o)=>{if(e){const n=document.activeElement;ue(e,{preventScroll:!0}),B.value=window.performance.now(),e!==n&&Le(e)&&o&&e.select()}};function G(e,o){const n=[...e],t=e.indexOf(o);return t!==-1&&n.splice(t,1),n}const we=()=>{let e=[];return{push:t=>{const r=e[0];r&&t!==r&&r.pause(),e=G(e,t),e.unshift(t)},remove:t=>{var r,f;e=G(e,t),(f=(r=e[0])==null?void 0:r.resume)==null||f.call(r)}}},Ce=(e,o=!1)=>{const n=document.activeElement;for(const t of e)if(l(t,o),document.activeElement!==n)return},X=we(),Oe=()=>g.value>B.value,y=()=>{$.value="pointer",g.value=window.performance.now()},Z=()=>{$.value="keyboard",g.value=window.performance.now()},he=()=>(K(()=>{b===0&&(document.addEventListener("mousedown",y),document.addEventListener("touchstart",y),document.addEventListener("keydown",Z)),b++}),D(()=>{b--,b<=0&&(document.removeEventListener("mousedown",y),document.removeEventListener("touchstart",y),document.removeEventListener("keydown",Z))}),{focusReason:$,lastUserFocusTimestamp:g,lastAutomatedFocusTimestamp:B}),_=e=>new CustomEvent(ye,{..._e,detail:e});let v=[];const ee=e=>{te(e)===se.esc&&v.forEach(n=>n(e))},Ne=e=>{K(()=>{v.length===0&&document.addEventListener("keydown",ee),z&&v.push(e)}),D(()=>{v=v.filter(o=>o!==e),v.length===0&&z&&document.removeEventListener("keydown",ee)})},Re=oe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Y,J,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:o}){const n=S();let t,r;const{focusReason:f}=he();Ne(s=>{e.trapped&&!p.paused&&o("release-requested",s)});const p={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},E=s=>{if(!e.loop&&!e.trapped||p.paused)return;const{altKey:a,ctrlKey:u,metaKey:c,currentTarget:i,shiftKey:C}=s,{loop:q}=e,ae=te(s)===se.tab&&!a&&!u&&!c,T=document.activeElement;if(ae&&T){const O=i,[h,N]=ge(O);if(h&&N){if(!C&&T===N){const d=_({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(s.preventDefault(),q&&l(h,!0))}else if(C&&[h,O].includes(T)){const d=_({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(s.preventDefault(),q&&l(N,!0))}}else if(T===O){const d=_({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||s.preventDefault()}}};fe(Pe,{focusTrapRef:n,onKeydown:E}),R(()=>e.focusTrapEl,s=>{s&&(n.value=s)},{immediate:!0}),R([n],([s],[a])=>{s&&(s.addEventListener("keydown",E),s.addEventListener("focusin",L),s.addEventListener("focusout",w)),a&&(a.removeEventListener("keydown",E),a.removeEventListener("focusin",L),a.removeEventListener("focusout",w))});const V=s=>{o(Y,s)},j=s=>o(J,s),L=s=>{const a=F(n);if(!a)return;const u=s.target,c=s.relatedTarget,i=u&&a.contains(u);e.trapped||c&&a.contains(c)||(t=c),i&&o("focusin",s),!p.paused&&e.trapped&&(i?r=u:l(r,!0))},w=s=>{const a=F(n);if(!(p.paused||!a))if(e.trapped){const u=s.relatedTarget;!ce(u)&&!a.contains(u)&&setTimeout(()=>{if(!p.paused&&e.trapped){const c=_({focusReason:f.value});o("focusout-prevented",c),c.defaultPrevented||l(r,!0)}},0)}else{const u=s.target;u&&a.contains(u)||o("focusout",s)}};async function H(){await W();const s=F(n);if(s){X.push(p);const a=s.contains(document.activeElement)?t:document.activeElement;if(t=a,!s.contains(a)){const c=new Event(I,M);s.addEventListener(I,V),s.dispatchEvent(c),c.defaultPrevented||W(()=>{let i=e.focusStartEl;ie(i)||(l(i),document.activeElement!==i&&(i="first")),i==="first"&&Ce(re(s),!0),(document.activeElement===a||i==="container")&&l(s)})}}}function x(){const s=F(n);if(s){s.removeEventListener(I,V);const a=new CustomEvent(A,{...M,detail:{focusReason:f.value}});s.addEventListener(A,j),s.dispatchEvent(a),!a.defaultPrevented&&(f.value=="keyboard"||!Oe()||s.contains(document.activeElement))&&l(t??document.body),s.removeEventListener(A,j),X.remove(p),t=null,r=null}}return K(()=>{e.trapped&&H(),R(()=>e.trapped,s=>{s?H():x()})}),D(()=>{e.trapped&&x(),n.value&&(n.value.removeEventListener("keydown",E),n.value.removeEventListener("focusin",L),n.value.removeEventListener("focusout",w),n.value=void 0)}),{onKeydown:E}}});function ke(e,o,n,t,r,f){return U(e.$slots,"default",{handleKeydown:e.onKeydown})}var je=ne(Re,[["render",ke],["__file","focus-trap.vue"]]);const Ie=de({to:{type:le([String,Object]),required:!0},disabled:Boolean}),Ae=oe({__name:"teleport",props:Ie,setup(e){return(o,n)=>o.disabled?U(o.$slots,"default",{key:0}):(ve(),pe(Ee,{key:1,to:o.to},[U(o.$slots,"default")],8,["to"]))}});var Ue=ne(Ae,[["__file","teleport.vue"]]);const He=me(Ue),Ke="utils/vue/vnode",xe=e=>{if(!m(e))return Te(Ke,"[getNormalizedProps] must be a VNode"),{};const o=e.props||{},n=(m(e.type)?e.type.props:void 0)||{},t={};return Object.keys(n).forEach(r=>{Fe(n[r],"default")&&(t[r]=n[r].default)}),Object.keys(o).forEach(r=>{t[be(r)]=o[r]}),t},P=e=>{const o=k(e)?e:[e],n=[];return o.forEach(t=>{var r;k(t)?n.push(...P(t)):m(t)&&((r=t.component)!=null&&r.subTree)?n.push(t,...P(t.component.subTree)):m(t)&&k(t.children)?n.push(...P(t.children)):m(t)&&t.shapeFlag===2?n.push(...P(t.type())):n.push(t)}),n};export{je as E,He as a,P as f,xe as g,Ie as t};
